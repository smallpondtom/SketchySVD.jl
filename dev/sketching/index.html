<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Sketching Algorithms · SketchySVD</title><meta name="title" content="Sketching Algorithms · SketchySVD"/><meta property="og:title" content="Sketching Algorithms · SketchySVD"/><meta property="twitter:title" content="Sketching Algorithms · SketchySVD"/><meta name="description" content="Documentation for SketchySVD."/><meta property="og:description" content="Documentation for SketchySVD."/><meta property="twitter:description" content="Documentation for SketchySVD."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/citations.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">SketchySVD</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><span class="tocitem">Mathematical Background</span><ul><li><a class="tocitem" href="../theory/">Theory</a></li><li class="is-active"><a class="tocitem" href>Sketching Algorithms</a><ul class="internal"><li><a class="tocitem" href="#Algorithm-Overview"><span>Algorithm Overview</span></a></li><li><a class="tocitem" href="#Main-Algorithm-(Algorithm-4.1-from-[TYUC2019](@cite))"><span>Main Algorithm (Algorithm 4.1 from [1])</span></a></li><li><a class="tocitem" href="#Optimized-Implementation-Details"><span>Optimized Implementation Details</span></a></li><li><a class="tocitem" href="#Batch-vs-Incremental-Processing"><span>Batch vs Incremental Processing</span></a></li><li><a class="tocitem" href="#Algorithm-Variants"><span>Algorithm Variants</span></a></li><li><a class="tocitem" href="#Parallelization-Opportunities"><span>Parallelization Opportunities</span></a></li><li><a class="tocitem" href="#Numerical-Stability"><span>Numerical Stability</span></a></li><li><a class="tocitem" href="#Error-Analysis"><span>Error Analysis</span></a></li><li><a class="tocitem" href="#Comparison-with-Standard-SVD"><span>Comparison with Standard SVD</span></a></li></ul></li><li><a class="tocitem" href="../rsvd/">Randomized SVD</a></li></ul></li><li><span class="tocitem">User Guide</span><ul><li><a class="tocitem" href="../quickstart/">Getting Started</a></li><li><a class="tocitem" href="../redux_maps/">Dimension Reduction Maps</a></li><li><a class="tocitem" href="../examples/">Examples</a></li></ul></li><li><a class="tocitem" href="../api/">API Reference</a></li><li><a class="tocitem" href="../paper/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Mathematical Background</a></li><li class="is-active"><a href>Sketching Algorithms</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Sketching Algorithms</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/smallpondtom/SketchySVD.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/smallpondtom/SketchySVD.jl/blob/https://github.com/smallpondtom/SketchySVD.jl/docs/src/sketching.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Sketching-Algorithms"><a class="docs-heading-anchor" href="#Sketching-Algorithms">Sketching Algorithms</a><a id="Sketching-Algorithms-1"></a><a class="docs-heading-anchor-permalink" href="#Sketching-Algorithms" title="Permalink"></a></h1><p>This page provides detailed information about the sketching algorithm implemented in SketchySVD.jl, based on [<a href="../paper/#TYUC2019">1</a>].</p><h2 id="Algorithm-Overview"><a class="docs-heading-anchor" href="#Algorithm-Overview">Algorithm Overview</a><a id="Algorithm-Overview-1"></a><a class="docs-heading-anchor-permalink" href="#Algorithm-Overview" title="Permalink"></a></h2><p>The SketchySVD algorithm processes a data matrix <span>$A = [a_1, a_2, \ldots, a_n]$</span> column by column, maintaining compressed representations (sketches) that enable efficient SVD computation.</p><h2 id="Main-Algorithm-(Algorithm-4.1-from-[TYUC2019](@cite))"><a class="docs-heading-anchor" href="#Main-Algorithm-(Algorithm-4.1-from-[TYUC2019](@cite))">Main Algorithm (Algorithm 4.1 from [<a href="../paper/#TYUC2019">1</a>])</a><a id="Main-Algorithm-(Algorithm-4.1-from-[TYUC2019](@cite))-1"></a><a class="docs-heading-anchor-permalink" href="#Main-Algorithm-(Algorithm-4.1-from-[TYUC2019](@cite))" title="Permalink"></a></h2><h3 id="Initialization-Phase"><a class="docs-heading-anchor" href="#Initialization-Phase">Initialization Phase</a><a id="Initialization-Phase-1"></a><a class="docs-heading-anchor-permalink" href="#Initialization-Phase" title="Permalink"></a></h3><p><strong>Input</strong>: Dimensions <span>$m, n$</span>, target rank <span>$r$</span>, sketching dimensions <span>$k, s, q$</span></p><p><strong>Initialize</strong>:</p><ol><li><p><strong>Random test matrices</strong>:</p><ul><li><span>$\Xi \in \mathbb{R}^{k \times m}$</span> (range test matrix)</li><li><span>$\Omega \in \mathbb{R}^{k \times n}$</span> (corange test matrix)</li><li><span>$\Phi \in \mathbb{R}^{s \times m}$</span> (core test matrix 1)</li><li><span>$\Psi \in \mathbb{R}^{s \times n}$</span> (core test matrix 2)</li><li><span>$\Theta \in \mathbb{R}^{q \times m}$</span> (error test matrix, Gaussian)</li></ul></li><li><p><strong>Sketch matrices</strong> (initialized to zero):</p><ul><li><span>$X \in \mathbb{R}^{k \times n}$</span> (corange sketch)</li><li><span>$Y \in \mathbb{R}^{m \times k}$</span> (range sketch)</li><li><span>$Z \in \mathbb{R}^{s \times s}$</span> (core sketch)</li><li><span>$E \in \mathbb{R}^{q \times n}$</span> (error sketch, optional)</li></ul></li></ol><h3 id="Streaming-Phase"><a class="docs-heading-anchor" href="#Streaming-Phase">Streaming Phase</a><a id="Streaming-Phase-1"></a><a class="docs-heading-anchor-permalink" href="#Streaming-Phase" title="Permalink"></a></h3><p><strong>For each column</strong> <span>$a_j$</span> (<span>$j = 1, 2, \ldots, n$</span>):</p><pre><code class="language-julia hljs"># Update corange sketch
X[:, j] = Ξ * a_j

# Update range sketch (rank-1 update)
Y = Y + a_j * Ω[j, :]&#39;

# Update core sketch
z = Φ * a_j
Z = Z + z * Ψ[j, :]&#39;

# Update error sketch (optional)
E[:, j] = Θ * a_j</code></pre><p><strong>Computational cost per column</strong>:</p><ul><li>Corange: <span>$O(km)$</span></li><li>Range: <span>$O(mk_{\text{nnz}})$</span> where <span>$k_{\text{nnz}}$</span> is number of non-zeros in <span>$\Omega[j,:]$</span></li><li>Core: <span>$O(sm + sk_{\text{nnz}})$</span></li><li>Error: <span>$O(qm)$</span></li></ul><h3 id="Finalization-Phase"><a class="docs-heading-anchor" href="#Finalization-Phase">Finalization Phase</a><a id="Finalization-Phase-1"></a><a class="docs-heading-anchor-permalink" href="#Finalization-Phase" title="Permalink"></a></h3><p><strong>After all columns processed</strong>:</p><ol><li><p><strong>Orthonormalize range sketch</strong>:</p><pre><code class="language-julia hljs">Q_Y = qr(Y).Q</code></pre></li><li><p><strong>Orthonormalize corange sketch</strong>:</p><pre><code class="language-julia hljs">Q_X = qr(X&#39;).Q</code></pre></li><li><p><strong>Form intermediate matrix</strong>:</p><pre><code class="language-julia hljs"># Solve (Φ * Q_Y) * C = Z
temp = (Φ * Q_Y) \ Z
# Solve C * (Ψ * Q_X)&#39; = temp
C = temp / (Ψ * Q_X)&#39;</code></pre></li><li><p><strong>Compute SVD of core matrix</strong>:</p><pre><code class="language-julia hljs">U_c, Σ_c, V_c = svd(C)</code></pre></li><li><p><strong>Extract rank-r approximation</strong>:</p><pre><code class="language-julia hljs">V = Q_Y * U_c[:, 1:r]
Σ = Σ_c[1:r]
W = Q_X * V_c[:, 1:r]</code></pre></li></ol><p><strong>Result</strong>: <span>$A \approx V \Sigma W^T$</span></p><h2 id="Optimized-Implementation-Details"><a class="docs-heading-anchor" href="#Optimized-Implementation-Details">Optimized Implementation Details</a><a id="Optimized-Implementation-Details-1"></a><a class="docs-heading-anchor-permalink" href="#Optimized-Implementation-Details" title="Permalink"></a></h2><h3 id="Memory-Layout"><a class="docs-heading-anchor" href="#Memory-Layout">Memory Layout</a><a id="Memory-Layout-1"></a><a class="docs-heading-anchor-permalink" href="#Memory-Layout" title="Permalink"></a></h3><p>SketchySVD uses column-major storage (Julia&#39;s default) for optimal performance:</p><ul><li>Sequential column access in streaming phase</li><li>Efficient BLAS operations for matrix multiplications</li><li>Cache-friendly memory access patterns</li></ul><h3 id="Sparse-Matrix-Optimizations"><a class="docs-heading-anchor" href="#Sparse-Matrix-Optimizations">Sparse Matrix Optimizations</a><a id="Sparse-Matrix-Optimizations-1"></a><a class="docs-heading-anchor-permalink" href="#Sparse-Matrix-Optimizations" title="Permalink"></a></h3><p>For sparse test matrices (e.g., <span>$\Omega, \Psi$</span>), rank-1 updates are optimized:</p><pre><code class="language-julia hljs"># Instead of: Y = Y + a_j * Ω[j, :]&#39;
# Use sparse iteration:
for (idx, val) in pairs(Ω[j, :])
    Y[:, idx] += val * a_j
end</code></pre><p>This avoids materializing dense intermediate results.</p><h3 id="BLAS-Level-3-Optimizations"><a class="docs-heading-anchor" href="#BLAS-Level-3-Optimizations">BLAS Level 3 Optimizations</a><a id="BLAS-Level-3-Optimizations-1"></a><a class="docs-heading-anchor-permalink" href="#BLAS-Level-3-Optimizations" title="Permalink"></a></h3><p>For batch updates (<code>dump!</code> operation):</p><pre><code class="language-julia hljs"># Optimized batch update using mul!
mul!(X, Ξ, A, ν, η)  # X = η*X + ν*(Ξ*A)
mul!(Y, A, Ω&#39;, ν, η)  # Y = η*Y + ν*(A*Ω&#39;)</code></pre><p>This leverages highly optimized BLAS routines.</p><h2 id="Batch-vs-Incremental-Processing"><a class="docs-heading-anchor" href="#Batch-vs-Incremental-Processing">Batch vs Incremental Processing</a><a id="Batch-vs-Incremental-Processing-1"></a><a class="docs-heading-anchor-permalink" href="#Batch-vs-Incremental-Processing" title="Permalink"></a></h2><h3 id="Incremental-Mode-(dump_allfalse)"><a class="docs-heading-anchor" href="#Incremental-Mode-(dump_allfalse)">Incremental Mode (<code>dump_all=false</code>)</a><a id="Incremental-Mode-(dump_allfalse)-1"></a><a class="docs-heading-anchor-permalink" href="#Incremental-Mode-(dump_allfalse)" title="Permalink"></a></h3><p><strong>Advantages</strong>:</p><ul><li>Constant memory footprint</li><li>True streaming capability</li><li>Can handle data larger than RAM</li></ul><p><strong>Use when</strong>:</p><ul><li>Data arrives sequentially</li><li>Memory is limited</li><li>Real-time processing needed</li></ul><h3 id="Batch-Mode-(dump_alltrue)"><a class="docs-heading-anchor" href="#Batch-Mode-(dump_alltrue)">Batch Mode (<code>dump_all=true</code>)</a><a id="Batch-Mode-(dump_alltrue)-1"></a><a class="docs-heading-anchor-permalink" href="#Batch-Mode-(dump_alltrue)" title="Permalink"></a></h3><p><strong>Advantages</strong>:</p><ul><li>Faster due to BLAS Level 3 operations</li><li>Better cache utilization</li><li>Fewer function calls</li></ul><p><strong>Use when</strong>:</p><ul><li>All data available at once</li><li>Memory is sufficient</li><li>Maximum speed required</li></ul><h2 id="Algorithm-Variants"><a class="docs-heading-anchor" href="#Algorithm-Variants">Algorithm Variants</a><a id="Algorithm-Variants-1"></a><a class="docs-heading-anchor-permalink" href="#Algorithm-Variants" title="Permalink"></a></h2><h3 id="Standard-Incremental-Update"><a class="docs-heading-anchor" href="#Standard-Incremental-Update">Standard Incremental Update</a><a id="Standard-Incremental-Update-1"></a><a class="docs-heading-anchor-permalink" href="#Standard-Incremental-Update" title="Permalink"></a></h3><pre><code class="language-julia hljs">increment!(sketchy, a_j)  # η=1, ν=1</code></pre><h3 id="Exponential-Forgetting"><a class="docs-heading-anchor" href="#Exponential-Forgetting">Exponential Forgetting</a><a id="Exponential-Forgetting-1"></a><a class="docs-heading-anchor-permalink" href="#Exponential-Forgetting" title="Permalink"></a></h3><pre><code class="language-julia hljs">increment!(sketchy, a_j, η, ν)  # η &lt; 1</code></pre><p>Useful for tracking time-varying subspaces.</p><h3 id="Fixed-Memory-Sketching"><a class="docs-heading-anchor" href="#Fixed-Memory-Sketching">Fixed-Memory Sketching</a><a id="Fixed-Memory-Sketching-1"></a><a class="docs-heading-anchor-permalink" href="#Fixed-Memory-Sketching" title="Permalink"></a></h3><p>Using storage budget <span>$T$</span>:</p><pre><code class="language-julia hljs">sketchy = init_sketchy(m=m, n=n, r=r, T=1000)</code></pre><p>Automatically determines optimal <span>$k, s$</span> for given memory constraint.</p><h2 id="Parallelization-Opportunities"><a class="docs-heading-anchor" href="#Parallelization-Opportunities">Parallelization Opportunities</a><a id="Parallelization-Opportunities-1"></a><a class="docs-heading-anchor-permalink" href="#Parallelization-Opportunities" title="Permalink"></a></h2><p>While the current implementation is sequential, several operations can be parallelized:</p><ol><li><strong>Independent sketch updates</strong>: <span>$X$</span> and <span>$E$</span> updates are independent</li><li><strong>Batch processing</strong>: Multiple columns can be processed in parallel</li><li><strong>Finalization</strong>: QR decompositions can use parallel BLAS</li></ol><h2 id="Numerical-Stability"><a class="docs-heading-anchor" href="#Numerical-Stability">Numerical Stability</a><a id="Numerical-Stability-1"></a><a class="docs-heading-anchor-permalink" href="#Numerical-Stability" title="Permalink"></a></h2><p>The algorithm maintains numerical stability through:</p><ol><li><strong>Orthonormalization</strong>: QR decompositions ensure orthonormal bases</li><li><strong>Scaling</strong>: Forgetting factors prevent overflow/underflow</li><li><strong>Stable linear solves</strong>: Uses backslash operator (LU/QR based)</li></ol><p>For ill-conditioned problems, consider:</p><ul><li>Increasing sketching dimensions <span>$k, s$</span></li><li>Using SVD instead of QR for orthonormalization</li><li>Regularization techniques</li></ul><h2 id="Error-Analysis"><a class="docs-heading-anchor" href="#Error-Analysis">Error Analysis</a><a id="Error-Analysis-1"></a><a class="docs-heading-anchor-permalink" href="#Error-Analysis" title="Permalink"></a></h2><p><strong>Sources of error</strong>:</p><ol><li><strong>Rank truncation</strong>: Approximating rank-<span>$\rho$</span> matrix with rank-<span>$r$</span> (<span>$r &lt; \rho$</span>)</li><li><strong>Sketching</strong>: Random projection introduces additional error</li><li><strong>Numerical</strong>: Finite precision arithmetic</li></ol><p><strong>Total error bound</strong> [<a href="../paper/#TYUC2019">1</a>]:</p><p class="math-container">\[\|A - V\Sigma W^T\|_F^2 \leq \sum_{i=r+1}^{\rho} \sigma_i^2(A) + \epsilon_{\text{sketch}} + \epsilon_{\text{num}}\]</p><p>The sketching error <span>$\epsilon_{\text{sketch}}$</span> decreases with <span>$k, s$</span>. Note that this a crude generalization and more precise bounds are available in the literature. For the SketchySVD algorithm, refer to <a href="../theory/">theory.md</a>.</p><h2 id="Comparison-with-Standard-SVD"><a class="docs-heading-anchor" href="#Comparison-with-Standard-SVD">Comparison with Standard SVD</a><a id="Comparison-with-Standard-SVD-1"></a><a class="docs-heading-anchor-permalink" href="#Comparison-with-Standard-SVD" title="Permalink"></a></h2><table><tr><th style="text-align: right">Aspect</th><th style="text-align: right">Standard SVD</th><th style="text-align: right">SketchySVD</th></tr><tr><td style="text-align: right">Memory</td><td style="text-align: right"><span>$O(mn)$</span></td><td style="text-align: right"><span>$O(k(m+n) + s^2)$</span></td></tr><tr><td style="text-align: right">Time (batch)</td><td style="text-align: right"><span>$O(mn \min(m,n))$</span></td><td style="text-align: right"><span>$O((k+s)mn)$</span></td></tr><tr><td style="text-align: right">Time (stream)</td><td style="text-align: right">Not applicable</td><td style="text-align: right"><span>$O(km + sn)$</span> per column</td></tr><tr><td style="text-align: right">Accuracy</td><td style="text-align: right">Exact</td><td style="text-align: right">Approximate</td></tr><tr><td style="text-align: right">Online</td><td style="text-align: right">No</td><td style="text-align: right">Yes</td></tr></table><p>SketchySVD is advantageous when:</p><ul><li><span>$k, s \ll \min(m,n)$</span></li><li>Streaming/online processing required</li><li>Memory constrained</li><li>Low-rank structure exists</li></ul></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../theory/">« Theory</a><a class="docs-footer-nextpage" href="../rsvd/">Randomized SVD »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Wednesday 26 November 2025 14:40">Wednesday 26 November 2025</span>. Using Julia version 1.12.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
